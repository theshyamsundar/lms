{% extends "base.html" %}
{% block content %}

<!-- =======================
     Learner Profile
     ======================= -->

<div class="page-header">
  <div>
    <div class="page-title">My Profile</div>
    <div class="page-subtitle">
      Your learning journey, achievements, and activity
    </div>
  </div>
</div>

<div class="row g-4">

  <!-- =======================
       LEFT COLUMN
       ======================= -->
  <div class="col-lg-4">

    <!-- Identity Card -->
    <div class="card section">
      <div class="card-body text-center">

        <!-- Avatar -->
        <div class="mb-3">
          <div class="rounded-circle bg-primary-soft text-primary d-inline-flex
                      align-items-center justify-content-center"
               style="width:72px;height:72px;font-size:26px;font-weight:600;">
            {{ user.email[0]|upper }}
          </div>
        </div>

        <h5 class="mb-1">{{ user.email }}</h5>
        <div class="text-muted-small mb-3">
          {{ user.role.replace('_',' ') }}
        </div>

        <div class="d-flex justify-content-around border-top pt-3">
          <div>
            <div class="fw-semibold">{{ points }}</div>
            <div class="text-muted-small">Points</div>
          </div>
          <div>
            <div class="fw-semibold">{{ streak }}</div>
            <div class="text-muted-small">Day Streak</div>
          </div>
          <div>
            <div class="fw-semibold">{{ badges|length }}</div>
            <div class="text-muted-small">Badges</div>
          </div>
        </div>

      </div>
    </div>

    <!-- Badges -->
    <div class="card section">
      <div class="card-header">Achievements</div>
      <div class="card-body">
        {% if badges|length == 0 %}
          <div class="empty-state">
            No badges earned yet.  
            Continue learning to unlock achievements.
          </div>
        {% else %}
          <div class="d-flex flex-wrap gap-2">
            {% for badge in badges %}
              <span class="badge bg-primary-soft text-primary">
                {{ badge }}
              </span>
            {% endfor %}
          </div>
        {% endif %}
      </div>
    </div>

  </div>

  <!-- =======================
       RIGHT COLUMN
       ======================= -->
  <div class="col-lg-8">

    <!-- Learning Summary -->
    <div class="card section">
      <div class="card-header">Learning Summary</div>
      <div class="card-body">
        <div class="row text-center">

          <div class="col-md-4">
            <div class="kpi-label">Courses Completed</div>
            <div class="kpi-value">{{ completed_courses }}</div>
          </div>

          <div class="col-md-4">
            <div class="kpi-label">Assessments Taken</div>
            <div class="kpi-value">{{ assessments_taken }}</div>
          </div>

          <div class="col-md-4">
            <div class="kpi-label">Surveys Submitted</div>
            <div class="kpi-value">{{ surveys_submitted }}</div>
          </div>

        </div>
      </div>
    </div>

    <!-- Activity History -->
    <div class="card section">
      <div class="card-header">Recent Activity</div>
      <div class="card-body">

        {% if activity|length == 0 %}
          <div class="empty-state">
            Your learning activity will appear here as you engage with programs.
          </div>
        {% else %}
          <ul class="list-group list-group-flush">
            {% for item in activity %}
              <li class="list-group-item">
                <div class="fw-semibold">
                  {{ item.title }}
                </div>
                <div class="text-muted-small">
                  {{ item.timestamp }}
                </div>
              </li>
            {% endfor %}
          </ul>
        {% endif %}

      </div>
    </div>

  </div>

</div>

{% endblock %}